# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
<!-- -------------structure----------------- -->
## Общая структура приложения.
Приложение состоит из следующих основных компонентов, разделенных на три вида сущностей: Модели / Сервисы / Отображение:

### Модели:
##### - Product (Модель товара):
>Модель данных (интерфейс) для представления товара. Включает идентификатор, категорию, название, изображение, цену и описание товара.

Свойства:
- id: string
- category: string
- title: string
- image: string
- description: string
- price: number

##### - CartItem (Модель элемента корзины):
>Модель данных (интерфейс) для представления элемента корзины. Включает идентификатор, название, цену и порядковый номер товара в корзине.

Свойства:
- id: string
- title: string
- price: number
- orderNumber: number

##### - OrderDetails (Модель заказа):
>Модель данных (интерфейс) для оформления заказа. Он содержит почту, телефон, способ оплаты, адрес доставки и список товаров в корзине. Этот интерфейс используется для передачи данных заказа на сервер для последующей обработки и подтверждения. 

Свойства:
- email: string
- phone: string
- paymentMethod: string
- deliveryAddress: string
- items: CartItem[]

### Сервисы:
##### - ApiService (Сервис для работы с API):
>Этот класс отвечает за взаимодействие с сервером для получения списка товаров и отправки заказов.

Свойства:
- api: Api

Методы:
- getProducts(): Promise<ApiListResponse<Product>>: Получение списка товаров с сервера.
- submitOrder(orderDetails: OrderDetails): Promise<void>: Отправка заказа на сервер.

##### - CartService (Сервис для работы с корзиной):
>Этот класс управляет состоянием корзины, включая добавление и удаление товаров, получение списка товаров в корзине и очистку корзины.

Свойства:
- items: CartItem[]

-Методы:
- getNextOrderNumber(): number: Вычисляет следующий порядковый номер для нового товара.
- addToCart(product: Product): void: Добавление товара в корзину.
- removeFromCart(productId: string): void: Удаление товара из корзины.
- getCartItems(): CartItem[]: Получение списка товаров в корзине.
- clearCart(): void: Очистка корзины.

##### - Validator (Валидатор):
>Этот класс предоставляет методы для валидации адреса, электронной почты и телефона.

Методы:
- validateAddress(address: string): boolean: Валидация адреса.
- validateEmail(email: string): boolean: Валидация email.
- validatePhone(phone: string): boolean: Валидация телефона.

### Отображение
##### - MainPage (Главная страница):
>Этот класс отвечает за отображение списка товаров и счетчика товаров в корзине. Методы включают рендеринг страницы, открытие корзины и обработку кликов на карточке товара.

Свойства:
- products: ProductCard[]
- cartCount: number

Методы:
- render(): Отображение списка товаров и счетчика товавор в корзине.
- openCart(): Открытие модального окна корзины.
- handleProductClick(productId: string): Открытие модального окна с детальной информацией о товаре.

##### - ProductCard (Карточка товара):
>Этот класс представляет отдельную карточку товара на главной странице. Он отображает информацию о товаре и позволяет пользователю открыть модальное окно с детальной информацией о товаре.

Свойства:
- product: Product: Информация о продукте, который будет отображаться на карточке.

Методы:
- render(): HTMLElement: Создает и возвращает элемент карточки продукта на основе шаблона. Устанавливает заголовок, изображение и цену продукта. Также добавляет обработчик событий для открытия модального окна с подробностями о продукте при клике на карточку.

##### - BaseModal (Модальное окно):
>Базовый класс для всех модальных окон в приложении, предоставляющий общие методы и свойства для работы с модальными окнами.

Свойства:
- modal: HTMLElement: HTML элемент модального окна.

Методы:
- open(): Добавляет класс modal_active для отображения модального окна.
- close(): Удаляет класс modal_active для скрытия модального окна.
- createCloseButton(): HTMLElement: Добавляет обработчик событий на кнопку закрытия модального окна.
- handleOutsideClick(event: MouseEvent): Обрабатывает клик за пределами модального окна для его закрытия.
- setupModal(): Настраивает модальное окно, добавляя необходимые обработчики событий.

##### - ProductDetailsModal (Модальное окно с детальной информацией о товаре):
>Этот класс наследует BaseModal и отвечает за отображение детальной информации о товаре. Он также предоставляет возможность добавить товар в корзину.

Свойства:
- product: Product: Информация о продукте для отображения в модальном окне.
- cartService: CartService: Сервис для работы с корзиной покупок.

Методы:
- render(): Создает и добавляет содержимое модального окна с информацией о продукте.
- handleBuyClick(): Обрабатывает клик на кнопку "Купить", добавляя продукт в корзину и закрывая модальное окно.

##### - CartModal (Модальное окно корзина):
>Этот класс наследует BaseModal и отображает список товаров в корзине и позволяет управлять ими (удалять). Так же позволяет пользователю перейти к оформлению заказа.

Свойства:
- cartService: CartService: Сервис для работы с корзиной покупок.

Методы:
- render(): Создает и добавляет содержимое модального окна с информацией о товарах в корзине.
- handleRemoveClick(event: Event): Обрабатывает клик на кнопку удаления товара из корзины.
- handleCheckoutClick(): Обрабатывает клик на кнопку оформления заказа.
- calculateTotalPrice(): number: Рассчитывает общую стоимость товаров в корзине.

##### - PaymentMethodModal (Модальное окно способа оплаты):
>Этот класс наследует BaseModal и предоставляет пользователю выбор способа оплаты, ввод адреса доставки и переход к модальному окну ввода почты и телефона.

Методы:
- render(): Создает и добавляет содержимое модального окна с выбором метода оплаты.
- handleNextClick(): Обрабатывает клик на кнопку "Далее" для перехода к следующему шагу.

##### - ContactInfoModal (Модальное окно для ввода почты и телефона покупателя):
>Этот класс наследует BaseModal и позволяет пользователю ввести контактные данные и завершить заказ перейдя к модальному окну с сообщением об успешной оплате.

Методы:
- render(): Создает и добавляет содержимое модального окна с формой ввода контактной информации.
- handleNextClick(): Обрабатывает клик на кнопку "Далее" для перехода к следующему шагу.

##### - SuccessModal (Модальное окно с сообщением об успешной оплате):
>Этот класс наследует BaseModal и отображает сообщение об успешной оплате и сумму списанную за заказ, а также предоставляет возможность вернуться на главный экран, закрыв модальное окно.

Свойства:
- amount: number: Сумма, списанная за заказ.

Методы:
- render(): Создает и добавляет содержимое модального окна с сообщением об успешном заказе.
- handleShopMoreClick(): Обрабатывает клик на кнопку "Продолжить покупки", закрывая модальное окно.

<!-- -----Example----- -->
### Пример сценария работы приложения на данной архитектуре:

1. MainPage и ApiService

-MainPage -> ApiService : getProducts()
-ApiService получает список товаров и возвращает их на MainPage.

2. MainPage

-MainPage -> render() : Отображение товаров и счетчика товаров в корзине
-MainPage отображает карточки товаров и счетчик товаров в корзине.

3. Пользователь кликает по карточке товара

-User -> MainPage : Клик по карточке с товаром
-MainPage -> ProductDetailsModal : open(productDetails)
-ProductDetailsModal -> render() : Отображение информации о товаре
-ProductDetailsModal открывается и отображает подробную информацию о товаре.

4. Пользователь кликает по кнопке "Купить"

-User -> ProductDetailsModal : Клик по кнопке 'купить'
-ProductDetailsModal -> CartService : addToCart(product)
-Товар добавляется в корзину.

5. Пользователь кликает по корзине

-User -> MainPage : Клик по корзине
-MainPage -> CartModal : open(cart)
-CartModal -> render() : Отображение товаров в корзине
-CartModal открывается и отображает товары, добавленные в корзину.

6. Пользователь кликает по кнопке "Оформить"

-User -> CartModal : Клик по кнопке 'оформить'
-CartModal -> PaymentMethodModal : open(paymentMethod)
-PaymentMethodModal -> render() : Отображение способов оплаты
-PaymentMethodModal открывается и отображает способы оплаты и поле для ввода адреса доставки.

7. Пользователь выбирает способ оплаты и заполняет адрес доставки

-User -> PaymentMethodModal : Выбор способа оплаты и заполнение адреса
-User -> PaymentMethodModal : Клик по кнопке 'далее'
-PaymentMethodModal -> ContactInfoModal : open(contactInfo)
-ContactInfoModal -> render() : Отображение полей для ввода контактных данных
-ContactInfoModal открывается и отображает поля для ввода контактных данных.

8. Пользователь заполняет поля контактных данных

-User -> ContactInfoModal : Заполнение почты и телефона
-User -> ContactInfoModal : Клик по кнопке 'оплатить'
-ContactInfoModal -> ApiService : submitOrder()
-ContactInfoModal -> SuccessModal : open(success)
-SuccessModal -> render() : Отображение сообщения об успешной оплате
-SuccessModal открывается и отображает сообщение об успешной оплате.

9. Пользователь кликает по кнопке закрытия попапа или "За новыми покупками"

-User -> SuccessModal : Клик по кнопке закрытия попапа или 'за новыми покупками'
-SuccessModal : closeModal() : Возврат на главную страницу
-SuccessModal закрывается, и пользователь возвращается на главную страницу.